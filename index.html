<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…¨æ ¼å¼æ™ºèƒ½è¡¨æ ¼å·¥å…· - ç¦»çº¿ç‰ˆ</title>
    <link href="https://unpkg.com/tabulator-tables@5.5.0/dist/css/tabulator_modern.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@5.5.0/dist/js/tabulator.min.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
    <style>
        body { font-family: 'PingFang SC', sans-serif; background: #f4f7f9; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .header { text-align: center; margin-bottom: 30px; }
        .upload-area { border: 2px dashed #3498db; padding: 40px; text-align: center; border-radius: 8px; cursor: pointer; transition: 0.3s; }
        .upload-area:hover { background: #f0f7ff; }
        .control-panel { margin: 20px 0; display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
        .btn { padding: 8px 16px; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; transition: 0.2s; }
        .btn-primary { background: #3498db; color: white; }
        .btn-success { background: #2ecc71; color: white; }
        .btn-danger { background: #e74c3c; color: white; }
        #data-table { margin-top: 20px; border-radius: 8px; overflow: hidden; }
        .style-tool { font-size: 13px; color: #666; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>ğŸ“Š å…¨æ ¼å¼è‡ªå®šä¹‰è¡¨æ ¼åˆ¶ä½œå·¥å…·</h1>
        <p>æ”¯æŒæ‹–æ‹½æ’ç‰ˆã€åŒå‡»ç¼–è¾‘ã€ä¸€é”®å¯¼å‡ºï¼ˆæ— éœ€AIï¼Œæé€Ÿå“åº”ï¼‰</p>
    </div>

    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
        <p>ç‚¹å‡»æˆ–æ‹–æ‹½ Excel/CSV æ–‡ä»¶åˆ°è¿™é‡Œ</p>
        <input type="file" id="fileInput" hidden accept=".xlsx, .xls, .csv">
    </div>

    <div class="control-panel">
        <button class="btn btn-primary" onclick="addRow()">â• æ·»åŠ è¡Œ</button>
        <button class="btn btn-primary" onclick="addColumn()">â• æ·»åŠ åˆ—</button>
        <button class="btn btn-success" onclick="downloadExcel()">ğŸ“¥ å¯¼å‡º Excel</button>
        <button class="btn btn-danger" onclick="clearTable()">ğŸ—‘ï¸ æ¸…ç©ºè¡¨æ ¼</button>
        <div class="style-tool">
            | å­—ä½“å¤§å°: <input type="number" id="fontSize" value="14" style="width: 40px;" onchange="updateStyle()">
            | ä¸»é¢˜è‰²: <input type="color" id="themeColor" value="#3498db" onchange="updateStyle()">
        </div>
    </div>

    <div id="data-table"></div>
</div>

<script>
    var table;

    // åˆå§‹åŒ–è¡¨æ ¼
    function initTable(data = []) {
        table = new Tabulator("#data-table", {
            data: data,
            autoColumns: true, // è‡ªåŠ¨ç”Ÿæˆè¡¨å¤´
            layout: "fitColumns",
            movableColumns: true, // å…è®¸æ‹–æ‹½åˆ—
            pagination: "local",
            paginationSize: 10,
            columnDefaults: {
                editor: "input", // å¼€å¯åŒå‡»ç¼–è¾‘
                headerFilter: "input", // å¼€å¯ç­›é€‰
                hozAlign: "center",
            },
            rowContextMenu: [
                { label: "åˆ é™¤æ­¤è¡Œ", action: function(e, row){ row.delete(); } }
            ]
        });
    }

    // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
    document.getElementById('fileInput').addEventListener('change', function(e) {
        var file = e.target.files[0];
        var reader = new FileReader();
        reader.onload = function(evt) {
            var data = new Uint8Array(evt.target.result);
            var workbook = XLSX.read(data, {type: 'array'});
            var sheet = workbook.Sheets[workbook.SheetNames[0]];
            var json = XLSX.utils.sheet_to_json(sheet);
            initTable(json);
        };
        reader.readAsArrayBuffer(file);
    });

    // è¾…åŠ©åŠŸèƒ½
    function addRow() { table.addRow({}); }
    function addColumn() { 
        var colName = prompt("è¯·è¾“å…¥åˆ—å", "æ–°åˆ—");
        if(colName) table.addColumn({title: colName, field: colName, editor: "input"});
    }
    function clearTable() { if(confirm("ç¡®å®šæ¸…ç©ºå—ï¼Ÿ")) table.clearData(); }
    function downloadExcel() { table.download("xlsx", "æˆ‘çš„è‡ªå®šä¹‰è¡¨æ ¼.xlsx"); }
    
    function updateStyle() {
        var size = document.getElementById('fontSize').value;
        var color = document.getElementById('themeColor').value;
        document.querySelector(".tabulator").style.fontSize = size + "px";
        document.querySelectorAll(".tabulator-col").forEach(el => el.style.backgroundColor = color);
    }

    // é»˜è®¤ç©ºè¡¨
    initTable([{"åºå·":"1", "å§“å":"ç¤ºä¾‹", "å†…å®¹":"åŒå‡»æˆ‘ä¿®æ”¹"}]);
</script>
</body>
</html>
